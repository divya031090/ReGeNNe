# ReGeNNe

Introduction

The proposed framework aims at combining genetic data into pathway structure and using an ensemble of Convolutional Neural Networks (CNN) along with a Canonical Correlation Regularizer layer for comprehensive prediction of disease risk. 



Information provided by this repository

Dataset: 

Datasets used can be downloaded from TCGA repository https://www.cancer.gov/about-nci/organization/ccg/research/structural-genomics/tcga. 

1) Kidney cancer dataset: https://xenabrowser.net/datapages/?cohort=TCGA%20Kidney%20Clear%20Cell%20Carcinoma%20(KIRC)&removeHub=https%3A%2F%2Fxena.treehouse.gi.ucsc.edu%3A443

Kidney cancer dataset where the outcome space consisted of 945 subjects with 553 subjects with early stage kidney cancer (Stage I and II) and 392 with late stage kidney cancer (Stage III and IV). Our algorithm aimed at classifying early or late stage kidney cancer based on their genetic and pathway information.

2) Liver Cancer dataset: https://xenabrowser.net/datapages/?cohort=TCGA%20Liver%20Cancer%20(LIHC)&removeHub=https%3A%2F%2Fxena.treehouse.gi.ucsc.edu%3A443

In this dataset we aimed at differentiating between the cancer type (liver/ kidney) based on the genetic data. We combined the samples from the liver and kidney cancer dataset to create a combined cohort of subjects. In this dataset we had a total of 1383 subjects with 945 subjects for kidney cancer and 438 for liver cancer.

3) Ovarian Cancer dataset: https://xenabrowser.net/datapages/?cohort=TCGA%20Ovarian%20Cancer%20(OV)&removeHub=https%3A%2F%2Fxena.treehouse.gi.ucsc.edu%3A443

In this study, the outcome space comprised of 362 subjects with overall survival at 2 years. We split the patients into alive and deceased groups with respect to their survival status. 





The real microbiome data used to generate MB-GAN samples analyzed in the manuscript

The csv files of the MB-GAN samples

The simulated data by alternative methods: Normal-To-Anything and metaSPARSim

The processed data used to generate figures and tables in the manuscript

R codes

The folder “Rcode” includes the following R scripts:

generate_NorTA.R: Simulate data by Normal-To-Anything (NorTA)

generate_metaSPARSim.R: Simulate data by metaSPARSim

process_MBGAN.R: Converts the csv files of MB-GAN samples to Rdata files

calculate_unifrac_dist.R: Calculate UniFrac distance for real microbiome samples and samples generated by three simulation methods (MBGAN, NorTA, metaSPARSim)

check_first_level_property.R: Compare sample sparsity, abundance, alpha diversity (by Shannon index), and beta diversity (by non-metric multidimensional scaling (nMDS) analysis)

check_second_level_property.R: Compare taxa-taxa associations using correlation structure and proportionality

mbgan_application_supp15.R: Compare differential abundance analysis results based on the real microbiome and MBGAN simulated samples

MiRKAT_simulation.R and MiRKAT_result_summary.R: Implement MiRKAT-based MWAS using MBGAN-simulated samples

generate_abundance_heatmap.R: Compare the abundances of the top 60 most abundant taxa across different datasets

The folder “Rcode_smalldataset” includes the similar R codes as above for a small microbiome dataset dicussed in the supplement.

Python codes

The root folder includes the following Python scripts:

mbgan_train_demo.py: codes to train a MB-GAN network
mbgan_inference_casectrl.py: codes to simulate new microbiome abundances using trained model parameters
The folder "code_check_convergence" includes Python scripts to validate the model convergence.

The folder "models" includes the trained model weights.

The folder "outputs" includes simulation outputs.

The folder "models_smaller_dataset" includes the following Python scripts (similar to above):

inference_case_ctrl.py: codes to simulate new microbiome abundances for a smaller microbiome dataset using trained model parameters
Contact

Xiaowei Zhan xiaowei.zhan@utsouthwestern.edu

Quantitative Biomedical Research Center

Center for the Genetics of Host Defence

Department of Population and Data Sciences

UT Southwestern Medical Center

Dallas, TX 75390-8821


Datasets used: can be downloaded from TCGA repository https://www.cancer.gov/about-nci/organization/ccg/research/structural-genomics/tcga. 

The files for Canonical Correlation Analysis based fusion are: CCA_gene.py and gene_fusion.py. The Convolutional Neural Network framework is presented in startified_CNN.py along with train_test.py for splitting the dataset. Pathway mapping.R can be used for pathway mapping to genes and common genes between pathways.


Prerequisites

Python 2.7

CUDA

cuDNN

Conda

TensorFlow

NumPy pandas

Keras
